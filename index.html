<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DPT</title>
<link href="style.css" rel="stylesheet">
<!--<script type="text/javascript" src="./ptp_files/jquery.mlens-1.0.min.js"></script>-->
<!--<script type="text/javascript" src="./ptp_files/jquery.js"></script>-->
<!--  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>-->
  <script type="text/javascript" src="./ptp_files/cat_hat.js"></script>
</head>

<body>
<div class="content">
  <h1>Diffusion Models and Semi-Supervised Learners Benefit Mutually with Few Labels</h1>
  <p id="authors"><a href="https://yyyouy.github.io/" target="_blank">Zebin You<sup>1</sup></a> Yong Zhong<sup>1</sup> <a href="https://baofff.github.io/" target="_blank">Fan Bao<sup>2</sup> </a> Jiacheng Sun<sup>3</sup> <a href="https://zhenxuan00.github.io/" target="_blank">Chongxuan li<sup>1</sup></a> <a href="https://ml.cs.tsinghua.edu.cn/~jun/index.shtml" target="_blank">Jun Zhu<sup>2</sup></a><br>

  <span style="font-size: 16px"><sup>1</sup> Gaoling School of AI, Renmin University of China; Beijing Key Laboratory of Big Data Management and Analysis Methods, Beijing, China &nbsp;&nbsp;<sup>2</sup> Dept. of Comp. Sci. & Tech., Institute for AI, Tsinghua-Huawei Joint Center for AI, BNRist Center, State Key Lab for Intell. Tech. & Sys., Tsinghua University &nbsp;&nbsp;<sup>3</sup> Huawei Noah's Ark Lab
  </span></p>
  <br>
  <img src="./ptp_files/dpt-overview.png" class="teaser-gif" style="width:100%;"><br>
    <font size="+2">
          <p style="text-align: center;">
            <a href="https://arxiv.org/abs/2302.10586" target="_blank">Paper</a> &nbsp;&nbsp;&nbsp;&nbsp;
            <a href="https://github.com/ML-GSAI/DPT/" target="_blank">Code</a>
          </p>
    </font>
</div>
<div class="content">
  <h2 style="text-align:center;">Abstract</h2>
  <p>We propose a three-stage training strategy called dual pseudo training (DPT) for conditional image generation and classification in semi-supervised learning. First, a classifier is trained on partially labeled data and predicts pseudo labels for all data. Second, a conditional generative model is trained on all data with pseudo labels and generates pseudo images given labels. Finally, the classifier is trained on real data augmented by pseudo images with labels. We demonstrate largescale diffusion models and semi-supervised learners benefit mutually with a few labels via DPT. In particular, on the ImageNet 256×256 generation benchmark, DPT can generate realistic, diverse, and semantically correct images with very few labels. With two (i.e., < 0.2%) and five (i.e., < 0.4%) labels per class, DPT achieves an FID of 3.44 and 3.37 respectively, outperforming strong diffusion models with full labels, such as IDDPM, CDM, ADM, and LDM. Besides, DPT outperforms competitive semi-supervised baselines substantially on ImageNet classification benchmarks with one, two, and five labels per class, achieving state-of-the-art top-1 accuracies of 59.0 (+2.8), 69.5 (+3.0), and 73.6 (+1.2) respectively.
    </p>
</div>
<div class="content">

  <h2>An overview of DPT</h2>
  <img class="summary-img" src="./ptp_files/overview.png" style="width:100%;">
  <p> First, a (self-supervised) classifier is trained on partially labeled data and used to predict pseudo labels
    for all data. Second, a (diffusion-based) conditional generative model is trained on all data with pseudo labels and used to generate pseudo
    images given random labels. Finally, the classifier is trained or fine-tuned on real data augmented by pseudo images with labels.</p>
     <br>
  <br>
</div>
<div class="content">
  <h2>Image generation results on ImageNet 256×256</h2>
  <p>
    We present the gap of FID between DPT and the supervised baseline in parentheses. With < 0.4% labels, DPT outperforms strong conditional generative models with full labels, including CDM (Ho et al., 2022), ADM (Dhariwal & Nichol, 2021) and LDM (Rombach et al., 2022).
  </p>
  <img class="summary-img" src="./ptp_files/generation.png" style="width:100%;">
    
  <h2>Top-1 accuracy on the ImageNet validation set with few labels. </h2>
  <p>
    We present the gain of DPT over the corresponding baseline in parentheses. With one, two, five labels per class, DPT improves the state-of-the-art semi-supervised learner MSN(Assran et al., 2022) consistently and substantially.

  </p>
  <img class="summary-img" src="./ptp_files/classification.png" style="width:100%;">

</div>
<div class="content">
  <h2>More random samples in specific classes from DPT</h2>
  <img class="summary-img" src="./ptp_files/more_samples.png" style="width:100%;">
  <h2>Random samples by varying the number of real labels in the first stage.</h2>
  <p>More real labels result in smaller noise in pseudo labels and samples of better visual quality and correct semantics. Top: “Custard apple”. Middle: “Geyser”. Bottom: “Goldfish”.</p>
  <img class="summary-img" src="./ptp_files/range_samples.png" style="width:100%;">
</div>
<div class="content">
  <h2>Conclusion</h2>
  <p>
    This paper presents a training strategy DPT for conditional image generation and classification in semi-supervised learning. DPT is simple to implement and achieves excellent performance in both tasks on ImageNet. DPT probably inspires future work in semi-supervised learning
  </p>
</div>


<div class="content">
  <h4>BibTex</h4>
  <p> @article{you2023diffusion,<br>
  &nbsp;&nbsp;title={Diffusion Models and Semi-Supervised Learners Benefit Mutually with Few Labels},<br>
  &nbsp;&nbsp;author={You, Zebin and Zhong, Yong and Bao, Fan and Sun, Jiacheng and Li, Chongxuan and Zhu, Jun},<br>
  &nbsp;&nbsp;booktitle={arXiv preprint arXiv:2302.10586},<br>
  &nbsp;&nbsp;year={2023}<br>
  }</p>
<br>
</div>
</body>
</html>
